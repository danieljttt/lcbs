<!DOCTYPE html>
<html lang="lv">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Little Community Becomes Something â€” Fantasy League</title>
<style>
:root{
  --bg:#e9f6ec; --text:#122617; --muted:#4a6b50; --line:#cfe7d6;
  --accent:#4CAF50; --accent2:#81C784; --accent3:#A5D6A7;
  --shadow:0 4px 12px rgba(0,0,0,.08);
}
body{margin:0;font-family:Inter,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text);}
main{padding-bottom:90px}
.card{background:linear-gradient(180deg,#f9fefb,#edf8ef);
 border:1px solid var(--line);border-radius:18px;padding:16px;box-shadow:var(--shadow);margin-bottom:12px;}
.btn{padding:8px 14px;border-radius:10px;border:1px solid var(--line);
 background:linear-gradient(180deg,#ffffff,#f1f9f3);cursor:pointer;font-weight:600}
.btn:hover{box-shadow:0 0 0 3px rgba(76,175,80,.25)}
.hidden{display:none!important}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:8px;border-bottom:1px solid var(--line);text-align:left}
.table th{color:var(--muted)}
.bottom-bar{position:fixed;bottom:0;left:0;right:0;display:flex;justify-content:space-around;
 background:#f3fbf5;border-top:1px solid var(--line);padding:8px 0;z-index:99}
.bottom-item{flex:1;text-align:center;font-size:13px;padding:6px 0;cursor:pointer}
.bottom-item.active{color:var(--accent);font-weight:700}
#toast{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);
 background:#fff;border:1px solid var(--accent3);padding:10px 16px;border-radius:10px;
 display:none;box-shadow:var(--shadow);z-index:999}
#toast.show{display:block;animation:fadein .3s, fadeout .3s 2.2s forwards}
@keyframes fadein{from{opacity:0;transform:translate(-50%,10px)}to{opacity:1;transform:translate(-50%,0)}}
@keyframes fadeout{to{opacity:0;transform:translate(-50%,10px)}}
.slide{max-height:0;overflow:hidden;transition:max-height .3s ease,opacity .3s ease;opacity:0}
.slide.open{opacity:1;max-height:300px}
</style>
</head>
<body>
<header class="card"><h2>Little Community Becomes Something</h2></header>
<main class="container">
<section id="view-home" class="card">
 <h3>SÄkums</h3>
 <div id="auth"></div>
 <div id="homeInfo"></div>
</section>
<section id="view-fantasy" class="card hidden">
 <h3>FentÄ“zi tirgus</h3>
 <div id="fantasySlots"></div>
 <div id="playerList"></div>
</section>
<section id="view-profile" class="card hidden">
 <h3>Mans profils</h3>
 <div id="profileInfo"></div>
</section>
<section id="view-leaders" class="card hidden">
 <h3>LÄ«deri</h3>
 <div id="leaders"></div>
</section>
<section id="view-admin" class="card hidden">
 <h3>Admin panelis</h3>
 <div id="adminPanel"></div>
</section>
</main>
<div id="toast">âœ… KredÄ«ti atgriezti</div>
<div class="bottom-bar">
 <div class="bottom-item" data-v="home">ğŸ  SÄkums</div>
 <div class="bottom-item" data-v="fantasy">ğŸ® FentÄ“zi</div>
 <div class="bottom-item" data-v="profile">ğŸ‘¤ Profils</div>
 <div class="bottom-item" data-v="leaders">ğŸ† LÄ«deri</div>
 <div class="bottom-item" id="adminBtn" data-v="admin" style="display:none">ğŸ›  Admin</div>
</div>
<script>
const STORE={players:"fc_players",users:"fc_users",cur:"fc_cur"};
function get(k,d){try{return JSON.parse(localStorage.getItem(k)||JSON.stringify(d))}catch(e){return d}}
function set(k,v){localStorage.setItem(k,JSON.stringify(v))}
function toast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500);}
</script>
<script>
const TEAM_SIZE=3;

// ===== Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ² =====
if(!get(STORE.players,[]).length){
  const arr=[
    {username:"toothfairy",team:"Holy Priests",tier:1,price:6,kd:1.31,adr:95,hs:45,kills:20,deaths:10,mvp:5,points:0},
    {username:"s1me",team:"Holy Priests",tier:1,price:6,kd:1.12,adr:88,hs:44,kills:18,deaths:11,mvp:4,points:0},
    {username:"Kirbitch",team:"Cotton Pickers",tier:2,price:4,kd:1.08,adr:80,hs:40,kills:15,deaths:13,mvp:3,points:0},
    {username:"K1rgo777",team:"Cotton Pickers",tier:2,price:4,kd:1.10,adr:83,hs:42,kills:14,deaths:12,mvp:2,points:0},
    {username:"MV",team:"9/11",tier:3,price:2,kd:0.95,adr:75,hs:36,kills:10,deaths:14,mvp:1,points:0}
  ];
  set(STORE.players,arr);
}

// ===== ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ =====
function cur(){return get(STORE.cur,null)}
function findUser(n){return get(STORE.users,[]).find(u=>u.username.toLowerCase()==n.toLowerCase())}
function upsertUser(u){let a=get(STORE.users,[]);const i=a.findIndex(x=>x.username.toLowerCase()==u.username.toLowerCase());if(i>=0)a[i]=u;else a.push(u);set(STORE.users,a);set(STORE.cur,u);}
function renderAuth(){
  const c=document.getElementById('auth'),u=cur();
  if(!u){c.innerHTML=`<input id="loginU" placeholder="LietotÄjvÄrds"><input id="loginP" type="password" placeholder="Parole">
   <button class="btn" onclick="register()">ReÄ£istrÄ“ties</button><button class="btn" onclick="login()">Ieiet</button>`;}
  else{c.innerHTML=`<span>Sveiks, <b>${u.username}</b></span> <button class="btn" onclick="logout()">Iziet</button>`;}
  document.getElementById('adminBtn').style.display=(u&&u.username.toLowerCase()=="dturannn")?"block":"none";
}
function register(){const n=document.getElementById('loginU').value.trim(),p=document.getElementById('loginP').value;if(!n||!p)return alert('Aizpildi laukus');if(findUser(n))return alert('Jau eksistÄ“');
 const o={username:n,password:p,team:[],budget:10,stake:100};upsertUser(o);renderAll();}
function login(){const n=document.getElementById('loginU').value.trim(),p=document.getElementById('loginP').value;const u=findUser(n);if(!u||u.password!=p)return alert('Nepareizi dati');set(STORE.cur,u);renderAll();}
function logout(){localStorage.removeItem(STORE.cur);renderAll();}

// ===== Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ =====
function renderHome(){
  renderAuth();
  const u=cur(),info=document.getElementById('homeInfo');
  if(!u){info.innerHTML="<p class='muted'>ReÄ£istrÄ“jies un izveido savu Fantasy komandu!</p>";return;}
  const team=u.team||[];
  const all=get(STORE.players,[]);
  let rows="";
  let total=0;
  team.forEach(n=>{
    const pl=all.find(p=>p.username==n);
    if(pl){total+=pl.kills*2+pl.mvp*3-pl.deaths;rows+=`<tr><td>${pl.username}</td><td>${pl.kills}</td><td>${pl.deaths}</td><td>${pl.mvp}</td><td>${pl.kills*2+pl.mvp*3-pl.deaths}</td></tr>`;}
  });
  info.innerHTML=`<p><b>BudÅ¾ets:</b> ${u.budget} kr</p>
  <table class='table'><tr><th>SpÄ“lÄ“tÄjs</th><th>Kills</th><th>Deaths</th><th>MVP</th><th>Punkti</th></tr>${rows}</table>
  <p><b>KopÄ:</b> ${total} p.</p>`;
}

// ===== Fantasy tirgus =====
function renderFantasy(){
  const u=cur(); if(!u){document.getElementById('fantasySlots').innerHTML="<p class='muted'>Vispirms ieejiet.</p>";return;}
  const slots=document.getElementById('fantasySlots');
  slots.innerHTML=[0,1,2].map(i=>{
    const n=u.team[i];return `<div class='card' style='margin-bottom:8px'>
     <b>Slot ${i+1}</b><br>${n?`${n} <button class='btn' onclick='removePlayer(${i})'>NoÅ†emt</button>`:`<button class='btn' onclick='openPicker(${i})'>IzvÄ“lÄ“ties</button>`}
    </div>`;}).join('');
  const all=get(STORE.players,[]);
  const list=document.getElementById('playerList');
  list.innerHTML="<table class='table'><tr><th></th><th>SpÄ“lÄ“tÄjs</th><th>Komanda</th><th>Cena</th><th></th></tr>"+
   all.map(pl=>{
     const c=pl.tier==1?"#2e7d32":pl.tier==2?"#66bb6a":"#a5d6a7";
     return `<tr style='border-left:4px solid ${c}'>
     <td><button onclick='toggleStat("${pl.username}")'>â–¾</button></td>
     <td>${pl.username}</td><td>${pl.team}</td><td>${pl.price}</td>
     <td><button class='btn' onclick='buy("${pl.username}")'>Pirkt</button></td>
     </tr>
     <tr id='stat-${pl.username}' class='slide'><td colspan='5'>
       <b>KD:</b> ${pl.kd} &nbsp; <b>ADR:</b> ${pl.adr} &nbsp; <b>MVP:</b> ${pl.mvp} &nbsp; <b>HS%:</b> ${pl.hs}
       <br><a href='https://steamcommunity.com/id/${pl.username}' target='_blank'>ğŸ”— Steam profils</a>
     </td></tr>`;
   }).join('')+"</table>";
}
function toggleStat(n){const e=document.getElementById('stat-'+n);e.classList.toggle('open');}
function buy(name){
  const u=cur();if(!u)return alert("Ieiet vispirms");
  const all=get(STORE.players,[]);const p=all.find(x=>x.username==name);
  if(!p)return;const t=u.team||[];
  if(t.includes(name))return alert("Jau komandÄ");
  if(t.length>=TEAM_SIZE)return alert("Komanda pilna");
  if(u.budget<p.price)return alert("Nepietiek budÅ¾ets");
  u.team.push(name);u.budget-=p.price;upsertUser(u);
  renderFantasy();renderHome();renderProfile();
}
function removePlayer(i){
  const u=cur();if(!u)return;const t=u.team||[];const n=t[i];if(!n)return;
  const all=get(STORE.players,[]);const p=all.find(x=>x.username==n);if(p){u.budget+=p.price;}
  t.splice(i,1);u.team=t;upsertUser(u);toast("âœ… KredÄ«ti atgriezti");renderFantasy();renderHome();renderProfile();
}

// ===== Profils =====
function renderProfile(){
  const u=cur();const box=document.getElementById('profileInfo');
  if(!u){box.innerHTML="<p class='muted'>Ieiet lai redzÄ“tu savu profilu.</p>";return;}
  const all=get(STORE.players,[]);
  const team=u.team||[];let rows="";let total=0;
  team.forEach(n=>{const pl=all.find(x=>x.username==n);if(pl){const pts=pl.kills*2+pl.mvp*3-pl.deaths;total+=pts;rows+=`<tr><td>${pl.username}</td><td>${pl.team}</td><td>${pl.kills}</td><td>${pl.deaths}</td><td>${pl.mvp}</td><td>${pts}</td></tr>`;}});
  box.innerHTML=`<p><b>Fantasy budÅ¾ets:</b> ${u.budget} kr</p>
  <table class='table'><tr><th>SpÄ“lÄ“tÄjs</th><th>Komanda</th><th>Kills</th><th>Deaths</th><th>MVP</th><th>Punkti</th></tr>${rows}</table>
  <p><b>KopÄ:</b> ${total} p.</p>`;
}
</script>
<script>
// ===== LÄ«deri =====
function renderLeaders(){
  const users=get(STORE.users,[]);const all=get(STORE.players,[]);
  let html="<table class='table'><tr><th></th><th>MenedÅ¾eris</th><th>Punkti</th></tr>";
  users.forEach(u=>{
    if(!u.team||!u.team.length)return;
    let pts=0;u.team.forEach(n=>{const p=all.find(x=>x.username==n);if(p)pts+=p.kills*2+p.mvp*3-p.deaths;});
    html+=`<tr><td><button onclick='toggleLeader("${u.username}")'>â–¾</button></td><td>${u.username}</td><td>${pts}</td></tr>
    <tr id='ldr-${u.username}' class='slide'><td colspan='3'>
      ${u.team.map(n=>{
        const p=all.find(x=>x.username==n);
        return p?`<div>${p.username} â€” K:${p.kills} D:${p.deaths} MVP:${p.mvp} (${p.kills*2+p.mvp*3-p.deaths} p)</div>`:"";
      }).join('')}
      <button class='btn' onclick='toggleLeader("${u.username}")'>âœ•</button>
    </td></tr>`;
  });
  html+="</table>";
  document.getElementById('leaders').innerHTML=html;
}
function toggleLeader(n){const e=document.getElementById('ldr-'+n);if(e)e.classList.toggle('open');}

// ===== Admin Panel =====
function renderAdmin(){
  const u=cur();const box=document.getElementById('adminPanel');
  if(!u||u.username.toLowerCase()!=='dturannn'){box.innerHTML="<p>PiekÄ¼uve tikai administratoram.</p>";return;}
  const players=get(STORE.players,[]);
  const users=get(STORE.users,[]);
  let phtml="<h4>SpÄ“lÄ“tÄju dati</h4><table class='table'><tr><th>VÄrds</th><th>Kills</th><th>Deaths</th><th>MVP</th></tr>";
  players.forEach(pl=>{
    phtml+=`<tr><td>${pl.username}</td>
     <td><input size='3' value='${pl.kills}' onchange='updStat("${pl.username}","kills",this.value)'></td>
     <td><input size='3' value='${pl.deaths}' onchange='updStat("${pl.username}","deaths",this.value)'></td>
     <td><input size='3' value='${pl.mvp}' onchange='updStat("${pl.username}","mvp",this.value)'></td></tr>`;
  });
  phtml+="</table><h4>LietotÄji</h4><table class='table'><tr><th>VÄrds</th><th>Fantasy</th><th>Likmes</th><th></th></tr>";
  users.forEach(us=>{
    phtml+=`<tr><td>${us.username}</td><td>${us.budget}</td><td>${us.stake}</td>
    <td><button class='btn' onclick='adj("${us.username}",1)'>+1</button>
    <button class='btn' onclick='adj("${us.username}",-1)'>-1</button></td></tr>`;
  });
  phtml+="</table>";
  box.innerHTML=phtml;
}
function updStat(name,field,val){const players=get(STORE.players,[]);const p=players.find(x=>x.username==name);
 if(p){p[field]=+val;set(STORE.players,players);renderHome();renderProfile();renderLeaders();toast("âœ… SaglabÄts");}}
function adj(name,d){const users=get(STORE.users,[]);const u=users.find(x=>x.username==name);
 if(u){u.budget+=d;set(STORE.users,users);renderAdmin();toast("âœ… Bilance mainÄ«ta");}}

// ===== ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ =====
document.querySelectorAll('.bottom-item').forEach(i=>i.onclick=()=>{
  const v=i.dataset.v;document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
  document.querySelectorAll('.bottom-item').forEach(s=>s.classList.remove('active'));
  document.getElementById('view-'+v).classList.remove('hidden');i.classList.add('active');
  renderView(v);
});
function renderView(v){
  if(v=="home")renderHome();
  if(v=="fantasy")renderFantasy();
  if(v=="profile")renderProfile();
  if(v=="leaders")renderLeaders();
  if(v=="admin")renderAdmin();
}
function renderAll(){renderHome();renderProfile();renderFantasy();renderLeaders();renderAdmin();}
renderAll();
</script>
</body>
</html>
